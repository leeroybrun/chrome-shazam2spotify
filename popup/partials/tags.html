<div class="topbar">
	<div class="right">
		<a class="simplelineicon clickable" ng-click="toggleShowFilters()" analytics-on analytics-event="Open filters" analytics-category="Tags" ng-if="updating() === false">
			<i class="icon-tag"></i>
		</a>
		<div class="dropdown" ng-show="shouldShowFilters">
			<a class="filter" ng-repeat="filter in statusFilters" ng-click="toggleStatusFilter(filter.status)" ng-class="{ selected: tagsStatusFilters.indexOf(filter.status) !== -1 }"><i class="{{filter.icon}}"></i></a>
		</div>
		<a class="simplelineicon clickable" ng-click="refreshTags()" analytics-on analytics-event="Manual refresh" analytics-category="Tags" ng-if="updating() === false">
			<i class="icon-refresh"></i>
		</a>
		<a class="simplelineicon" ng-if="updating() === true">
			<i class="icon-refresh icon-spin"></i>
		</a>
		<a class="simplelineicon" href="#/settings">
			<i class="icon-settings"></i>
		</a>
	</div>
	<h2 chrome-translate>myTags</h2>
</div>
<div class="tags-list">
	<div class="updating" ng-if="updating() === true">
		<div class="content">
			<div class="simplelineicon">
				<i class="icon-refresh icon-spin"></i>
			</div>
			<p><span class="updating-tags" chrome-translate>updatingTags</span><br />{{updateStatus}}</p>
			<p chrome-translate>doNotCloseBrowser</p>
		</div>
	</div>
	<div class="loading" ng-if="loading === true && updating() === false">
		<div class="content">
			<div class="simplelineicon">
				<i class="icon-refresh icon-spin"></i>
			</div>
			<p chrome-translate>loadingTags</p>
		</div>
	</div>
	<div class="no-tags" ng-if="!tags">
		<p class="simplelineicon">
			<i class="icon-exclamation"></i>
		</p>
		<p chrome-translate>noTagsFound</p>
	</div>
	<div class="tag" nb-class="{'tag-success': tag.status == 3, 'tag-search': tag.status == 1, 'tag-error': tag.status == 2}" ng-repeat="tag in tags() | filter:filterByStatus track by tag.shazamId">
		<div class="tag-status">
			<div class="success clickable" ng-if="tag.status >= 3" ng-click="retryTagSearch(tag)" analytics-on analytics-event="Retry tag search on already found" analytics-category="Tags" ng-class="{'pending': tag.status == 3}">
				<div class="simplelineicon">
					<i class="icon-check"></i>
				</div>
			</div>
			<div class="error" ng-if="tag.status == 2">
				<div class="simplelineicon clickable" ng-click="retryTagSearch(tag)" analytics-on analytics-event="Retry tag search" analytics-category="Tags">
					<i class="icon-close"></i>
				</div>
			</div>
			<div class="search" ng-if="tag.status == 1">
				<div class="simplelineicon">
					<i class="icon-clock"></i>
				</div>
			</div>
		</div>
		<img ng-if="tag.image" ng-src="{{tag.image}}" class="tag-image">
		<img ng-if="!tag.image" src="img/placeholder.png" class="tag-image">
		<div class="tag-name">{{tag.name}}</div>
		<div class="tag-artist">{{tag.artist}}</div>
	</div>
	<div class="pagination">
		<button class="pure-button pure-button-primary" analytics-on analytics-event="Prev page" analytics-category="Tags" ng-disabled="!pagination.hasPrevPage()" ng-click="pagination.prevPage()">
        <-
    </button>
    <button class="btn btn-default" disabled>
        {{pagination.page+1}}/{{pagination.nbPages()}}
    </button>
    <button class="pure-button pure-button-primary" analytics-on analytics-event="Next page" analytics-category="Tags" ng-disabled="!pagination.hasNextPage()" ng-click="pagination.nextPage()">
        ->
    </button>
	</div>
	<div class="modal-overlay" ng-if="newSearch.show" ng-click="newSearch.cancel()"></div>
	<div class="modal new-search-modal" ng-if="newSearch.show">
		<p chrome-translate ng-if="newSearch.tag.status != 2">changeTrackSearch</p>
		<p chrome-translate ng-if="newSearch.tag.status == 2">trackNotFound</p>
		<form ng-submit="newSearch.send()">
			<p><label chrome-translate>trackField</label><br />
			<input type="text" ng-model="newSearch.query.track"></p>
			<p><label chrome-translate>artistField</label><br />
			<input type="text" ng-model="newSearch.query.artist"></p>
			<p><button type="submit" class="pure-button pure-button-primary" chrome-translate analytics-on analytics-event="Start search" analytics-category="Retry search modal">searchTrackButton</button><a class="pure-button pure-button-warning cancel-button" ng-click="newSearch.cancel()" chrome-translate analytics-on analytics-event="Cancel" analytics-category="Retry search modal">cancel</a></p>
			<p class="error-msg" ng-if="newSearch.error">{{newSearch.error}}</p>
		</form>
		<div class="results-tracks-list" ng-if="newSearch.results.length > 0">
			<h3 chrome-translate>searchResults</h3>
			<hr />
			<p chrome-translate>searchResultsPleaseSelect</p>
			<a ng-click="newSearch.selectTrack(track)" ng-class="{selected: track.id == newSearch.selectedTrack.id}" class="tag search-result clickable" ng-repeat="track in newSearch.results track by track.id">
				<div class="tag-status" ng-if="newSearch.selectedTrack && track.id == newSearch.selectedTrack.id">
					<div class="success">
						<div class="simplelineicon">
							<i class="icon-check"></i>
						</div>
					</div>
				</div>
				<img ng-if="track.image" ng-src="{{track.image}}" class="tag-image">
				<img ng-if="!track.image" src="img/placeholder.png" class="tag-image">
				<div class="tag-name">{{track.name}}</div>
				<div class="tag-artist">{{track.artist}}</div>
			</a>
		</div>
	</div>
</div>